name: Build

on:
  workflow_dispatch:

permissions:
  contents: read

jobs:
  run-script:
    runs-on: ubuntu-latest
    outputs: 
      vers: ${{ steps.workflow_info.outputs.vers }}
      env_name: ${{ steps.workflow_info.outputs.env_name }}
      
    steps:
      - name: Git clone the repository
        uses: actions/checkout@v4

      - name: Set up Python 3.x
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      # - name: Run Python script
      #   run: |
      #     cd py_code
      #     python echo_items.py

      - name: Get workflow info
        id: workflow_info
        run: |          
          echo "vers=$GITHUB_RUN_NUMBER.$GITHUB_RUN_ID" >> $GITHUB_OUTPUT
          echo "env_name=$(echo "$GITHUB_REF" | cut -d'/' -f3) >> $GITHUB_OUTPUT

  edit-badges:
    needs: run-script
    uses: mm808/call-py-script-workflow/.github/workflows/edit_badges.yml@dev
    with:
      vers: ${{needs.run-script.outputs.vers}}
      env_name: ${{needs.run-script.outputs.env_name}}
